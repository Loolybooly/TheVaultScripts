-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

-- Player
local player = Players.LocalPlayer
local dodge = false
local dodgeUp = false
local dodgeDistance = 10
local dodgeUpDistance = 15
local espEnabled = false
local espObjects = {}

-- GUI (Rayfield)
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "Slap Battles",
    LoadingTitle = "By The Vault Scripts",
    LoadingSubtitle = "Designed by Looly",
    Theme = "Default",
})

-- Tabs
local Tab = Window:CreateTab("Main", 4483362458)

-- Discord Invite
Tab:CreateButton({
    Name = "ðŸ“‹ Copy Discord Invite",
    Callback = function()
        setclipboard("https://discord.gg/NUsQx6pnyQ")
    end
})

-- Special Features
Tab:CreateSection("Special Features")

-- Glove Reach Toggle
Tab:CreateToggle({
    Name = "Glove Reach",
    CurrentValue = false,
    Callback = function(state)
        getgenv().GloveReach = state
    end
})

-- Slapple Farm
Tab:CreateSection("Slapple Farm")
Tab:CreateToggle({
    Name = "Slapple Farm",
    CurrentValue = false,
    Callback = function(state)
        getgenv().slapfarmspissb = state
        if state then
            task.spawn(function()
                while getgenv().slapfarmspissb do
                    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                    if hrp then
                        for _, v in pairs(Workspace.Arena.island5.Slapples:GetDescendants()) do
                            if v.Name == "Glove" and v:FindFirstChild("TouchInterest") then
                                firetouchinterest(hrp, v, 0)
                                firetouchinterest(hrp, v, 1)
                            end
                        end
                    end
                    task.wait(1)
                end
            end)
        end
    end,
})

-- ESP
Tab:CreateSection("ESP")
Tab:CreateToggle({
    Name = "ESP",
    CurrentValue = false,
    Callback = function(state)
        espEnabled = state
        for _, objs in pairs(espObjects) do
            for _, obj in ipairs(objs) do
                obj:Destroy()
            end
        end
        espObjects = {}
        if state then
            RunService:BindToRenderStep("ESP", Enum.RenderPriority.Camera.Value + 1, function()
                for _, plr in pairs(Players:GetPlayers()) do
                    if plr ~= player and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                        local hrp = plr.Character.HumanoidRootPart
                        if not espObjects[plr] then
                            espObjects[plr] = {}

                            -- Glove ESP Text (Only shows glove name)
                            local gloveBill = Instance.new("BillboardGui", hrp)
                            gloveBill.Size = UDim2.new(0, 200, 0, 50)
                            gloveBill.StudsOffset = Vector3.new(0, 4.5, 0) -- Adjusted position (moved text higher)
                            gloveBill.AlwaysOnTop = true
                            local gloveText = Instance.new("TextLabel", gloveBill)
                            gloveText.Size = UDim2.new(1, 0, 1, 0)
                            gloveText.BackgroundTransparency = 1
                            gloveText.TextColor3 = Color3.new(1, 0, 0)
                            gloveText.TextStrokeTransparency = 0
                            gloveText.TextScaled = false
                            gloveText.Font = Enum.Font.SourceSansBold
                            gloveText.TextSize = 18
                            gloveText.Text = plr.leaderstats and plr.leaderstats.Glove and plr.leaderstats.Glove.Value or "Loading"
                            table.insert(espObjects[plr], gloveBill)
                           
                            -- Torso ESP Box (Correct R6 Size: 2x2x1)
                            local box = Instance.new("BoxHandleAdornment", hrp)
                            box.Size = Vector3.new(2, 2, 1) -- Matches R6 torso
                            box.Color3 = Color3.new(0.5, 0, 0)
                            box.Transparency = 0
                            box.AlwaysOnTop = true
                            box.Adornee = hrp
                            table.insert(espObjects[plr], box)
                        end
                    end
                end
            end)
        else
            RunService:UnbindFromRenderStep("ESP")
        end
    end,
})

-- Dodge
Tab:CreateSection("Dodge")
Tab:CreateToggle({
    Name = "Dodge (Press Q)",
    CurrentValue = false,
    Callback = function(value)
        dodge = value
    end,
})
Tab:CreateInput({
    Name = "Dodge Distance",
    PlaceholderText = tostring(dodgeDistance),
    Callback = function(text)
        dodgeDistance = tonumber(text) or 10
    end,
})
Tab:CreateToggle({
    Name = "Dodge Up (Press Z)",
    CurrentValue = false,
    Callback = function(value)
        dodgeUp = value
    end,
})
Tab:CreateInput({
    Name = "Dodge Up Distance",
    PlaceholderText = tostring(dodgeUpDistance),
    Callback = function(text)
        dodgeUpDistance = tonumber(text) or 15
    end,
})

-- Input Handler for Dodge
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and player.Character then
        local hrp = player.Character:FindFirstChild("HumanoidRootPart")
        if input.KeyCode == Enum.KeyCode.Q and dodge and hrp then
            hrp.CFrame = hrp.CFrame + hrp.CFrame.LookVector * dodgeDistance
        elseif input.KeyCode == Enum.KeyCode.Z and dodgeUp and hrp then
            hrp.CFrame = hrp.CFrame + Vector3.new(0, dodgeUpDistance, 0)
        end
    end
end)

-- Teleports
Tab:CreateSection("Teleport")
local teleportLocations = {
    ["Main Island"] = Vector3.new(2.1791, -5.173, 5.9531),
    ["Lobby"] = Vector3.new(-900.5245, 328.0385, -2.0989),
    ["Cube of Death Island"] = Vector3.new(-242.0591, -5.2782, 2.3795),
    ["Cube of Death"] = Vector3.new(-270.1338, -5.2782, 0.6983),
    ["Slapple Island"] = Vector3.new(-394.4224, 50.7642, -13.9544),
    ["Cannon Island"] = Vector3.new(254.4748, 33.6846, 192.0113),
    ["Brazil"] = Vector3.new(-820.2054, 305.506, -2.2074),
}
for name, pos in pairs(teleportLocations) do
    Tab:CreateButton({
        Name = "Teleport to " .. name,
        Callback = function()
            local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                hrp.CFrame = CFrame.new(pos + Vector3.new(0, 5, 0))
            end
        end
    })
end

-- Glove Reach Logic
RunService.Stepped:Connect(function()
    if getgenv().GloveReach then
        local char = player.Character
        if char and char:FindFirstChild("entered") then
            for _, obj in ipairs(char:GetChildren()) do
                if obj.Name:lower():find("glove") and obj:IsA("BasePart") then
                    obj.CanTouch = true
                    obj.Size = Vector3.new(50, 50, 50) -- Enlarged hitbox
                end
            end
        end
    end
end)

Rayfield:LoadConfiguration()
