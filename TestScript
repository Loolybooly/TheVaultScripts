-- ESP for Slap Battles: Shows Player Name + Glove Name

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local function createESPTag(character, player)
	if not character or not player then return end
	local head = character:FindFirstChild("Head")
	if not head then return end

	if head:FindFirstChild("ESPTag") then
		head:FindFirstChild("ESPTag"):Destroy()
	end

	local billboard = Instance.new("BillboardGui")
	billboard.Name = "ESPTag"
	billboard.Adornee = head
	billboard.Size = UDim2.new(0, 200, 0, 50)
	billboard.StudsOffset = Vector3.new(0, 2, 0)
	billboard.AlwaysOnTop = true
	billboard.Parent = head

	local nameLabel = Instance.new("TextLabel")
	nameLabel.Name = "NameLabel"
	nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
	nameLabel.Position = UDim2.new(0, 0, 0, 0)
	nameLabel.BackgroundTransparency = 1
	nameLabel.TextColor3 = Color3.new(1, 1, 1)
	nameLabel.TextStrokeTransparency = 0
	nameLabel.Font = Enum.Font.SourceSansBold
	nameLabel.TextSize = 14
	nameLabel.Text = player.DisplayName
	nameLabel.Parent = billboard

	local gloveLabel = Instance.new("TextLabel")
	gloveLabel.Name = "GloveLabel"
	gloveLabel.Size = UDim2.new(1, 0, 0.5, 0)
	gloveLabel.Position = UDim2.new(0, 0, 0.5, 0)
	gloveLabel.BackgroundTransparency = 1
	gloveLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
	gloveLabel.TextStrokeTransparency = 0
	gloveLabel.Font = Enum.Font.SourceSansBold
	gloveLabel.TextSize = 14
	gloveLabel.Text = "Loading..."
	gloveLabel.Parent = billboard

	-- Update glove label
	local function updateGlove()
		local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
		if tool then
			gloveLabel.Text = "Glove: " .. tool.Name
		else
			gloveLabel.Text = "Glove: None"
		end
	end

	-- Update glove every 0.5s
	task.spawn(function()
		while character and character:FindFirstChild("Head") and character:FindFirstChild("Humanoid") and character.Humanoid.Health > 0 do
			updateGlove()
			task.wait(0.5)
		end
	end)
end

local function addESPToPlayer(player)
	player.CharacterAdded:Connect(function(char)
		char:WaitForChild("Head")
		createESPTag(char, player)
	end)

	if player.Character then
		createESPTag(player.Character, player)
	end
end

-- Apply to all current players
for _, plr in pairs(Players:GetPlayers()) do
	if plr ~= Players.LocalPlayer then
		addESPToPlayer(plr)
	end
end

-- New players
Players.PlayerAdded:Connect(function(player)
	if player ~= Players.LocalPlayer then
		addESPToPlayer(player)
	end
end)
