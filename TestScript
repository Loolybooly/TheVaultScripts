-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- Player
local player = Players.LocalPlayer
local dodgeForward = false
local dodgeUp = false
local dodgeDistance = 10
local dodgeHeight = 10
local espEnabled = false

-- GUI (Rayfield)
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "Slap Battles",
    LoadingTitle = "By The Vault Scripts",
    LoadingSubtitle = "Coded by Muye & Looly",
    Theme = "Default",
})
local Tab = Window:CreateTab("Main", 4483362458)

-- TELEPORT LOCATIONS
local teleportLocations = {
    ["Main Island"] = Vector3.new(2.1791, -5.173, 5.9531),
    ["Lobby"] = Vector3.new(-900.5245, 328.0385, -2.0989),
    ["Cube of Death Island"] = Vector3.new(-242.0591, -5.2782, 2.3795),
    ["Cube of Death"] = Vector3.new(-270.1338, -5.2781, 0.6982),
    ["Slapple Island"] = Vector3.new(-394.4224, 50.7642, -13.9544),
    ["Cannon Island"] = Vector3.new(254.4748, 33.6846, 192.0113),
    ["Brazil"] = Vector3.new(-820.2054, 305.506, -2.2074),
}

local function teleportToLocation(name)
    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    if hrp and teleportLocations[name] then
        hrp.CFrame = CFrame.new(teleportLocations[name] + Vector3.new(0, 5, 0))
    end
end

-- SLAPPLE FARM
Tab:CreateSection("Slapple Farm")
Tab:CreateToggle({
    Name = "Slapple Farm",
    CurrentValue = false,
    Callback = function(state)
        getgenv().slapfarmspissb = state
        if state then
            task.spawn(function()
                while getgenv().slapfarmspissb do
                    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        for _, v in pairs(workspace.Arena.island5.Slapples:GetDescendants()) do
                            if v.Name == "Glove" and v:FindFirstChild("TouchInterest") then
                                firetouchinterest(player.Character.HumanoidRootPart, v, 0)
                                firetouchinterest(player.Character.HumanoidRootPart, v, 1)
                                task.wait(0.5)
                            end
                        end
                    end
                    task.wait(1)
                end
            end)
        end
    end,
})

-- ESP
Tab:CreateSection("ESP")
Tab:CreateToggle({
    Name = "ESP",
    CurrentValue = false,
    Callback = function(Value)
        espEnabled = Value
    end,
})

local function createESP(player)
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "VaultESP"
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true

    local gloveLabel = Instance.new("TextLabel")
    gloveLabel.Name = "Glove"
    gloveLabel.Size = UDim2.new(1, 0, 0, 25)
    gloveLabel.Position = UDim2.new(0, 0, 0, 0)
    gloveLabel.BackgroundTransparency = 1
    gloveLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
    gloveLabel.TextSize = 18
    gloveLabel.Font = Enum.Font.SourceSansBold
    gloveLabel.TextStrokeTransparency = 0.5
    gloveLabel.Text = "Loading..."

    local nameLabel = Instance.new("TextLabel")
    nameLabel.Name = "Name"
    nameLabel.Size = UDim2.new(1, 0, 0, 25)
    nameLabel.Position = UDim2.new(0, 0, 0, 25)
    nameLabel.BackgroundTransparency = 1
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextSize = 14
    nameLabel.Font = Enum.Font.SourceSansBold
    nameLabel.TextStrokeTransparency = 0.5
    nameLabel.Text = player.Name

    gloveLabel.Parent = billboard
    nameLabel.Parent = billboard

    return billboard
end

RunService.RenderStepped:Connect(function()
    for _, target in pairs(Players:GetPlayers()) do
        if target ~= player and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = target.Character.HumanoidRootPart

            if not hrp:FindFirstChild("ESPBox") and espEnabled then
                local box = Instance.new("BoxHandleAdornment")
                box.Name = "ESPBox"
                box.Adornee = hrp
                box.AlwaysOnTop = true
                box.ZIndex = 10
                box.Size = hrp.Size
                box.Transparency = 0.3
                box.Color3 = Color3.fromRGB(139, 0, 0)
                box.Parent = hrp
            elseif hrp:FindFirstChild("ESPBox") and not espEnabled then
                hrp:FindFirstChild("ESPBox"):Destroy()
            end

            if not hrp:FindFirstChild("VaultESP") and espEnabled then
                local esp = createESP(target)
                esp.Parent = hrp
            elseif hrp:FindFirstChild("VaultESP") and not espEnabled then
                hrp:FindFirstChild("VaultESP"):Destroy()
            end

            if espEnabled and hrp:FindFirstChild("VaultESP") then
                local label = hrp:FindFirstChild("VaultESP")
                if label and target.leaderstats and target.leaderstats:FindFirstChild("Glove") then
                    label.Glove.Text = target.leaderstats.Glove.Value
                end
            end
        end
    end
end)

-- DODGE SECTION
Tab:CreateSection("Dodge")
Tab:CreateToggle({
    Name = "Dodge (Press Q)",
    CurrentValue = false,
    Callback = function(Value)
        dodgeForward = Value
    end,
})

Tab:CreateInput({
    Name = "Dodge Distance",
    PlaceholderText = tostring(dodgeDistance),
    Callback = function(Text)
        dodgeDistance = tonumber(Text) or 10
    end,
})

Tab:CreateToggle({
    Name = "Dodge Up (Press E)",
    CurrentValue = false,
    Callback = function(Value)
        dodgeUp = Value
    end,
})

Tab:CreateInput({
    Name = "Dodge Up Distance",
    PlaceholderText = tostring(dodgeHeight),
    Callback = function(Text)
        dodgeHeight = tonumber(Text) or 10
    end,
})

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    if input.KeyCode == Enum.KeyCode.Q and dodgeForward and hrp then
        hrp.CFrame = hrp.CFrame + hrp.CFrame.LookVector * dodgeDistance
    elseif input.KeyCode == Enum.KeyCode.E and dodgeUp and hrp then
        hrp.CFrame = hrp.CFrame + Vector3.new(0, dodgeHeight, 0)
    end
end)

-- TELEPORT SECTION
Tab:CreateSection("Teleport")

local locations = {
    "Main Island", "Lobby", "Cube of Death Island", "Cube of Death",
    "Slapple Island", "Cannon Island", "Brazil"
}

for _, location in pairs(locations) do
    Tab:CreateButton({
        Name = "Teleport to " .. location,
        Callback = function()
            teleportToLocation(location)
        end
    })
end

Rayfield:LoadConfiguration()
